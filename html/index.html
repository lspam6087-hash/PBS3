<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MD-PBS: Documentation of MD-PBS</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MD-PBS<span id="projectnumber">&#160;6.1.1</span>
   </div>
   <div id="projectbrief">Molecular dynamics code for the PBS course</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Documentation of MD-PBS </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#intro_sec">Introduction </a>
  </li>
  <li class="level1">
    <a href="#structure_sec">Code Structure </a>
  </li>
  <li class="level1">
    <a href="#key_components">Key Components </a>
  </li>
  <li class="level1">
    <a href="#simulation_flow">Simulation Flow </a>
  </li>
  <li class="level1">
    <a href="#additional_info">Additional Information </a>
  </li>
</ul>
</div>
<div class="textblock"><p>This is the base Molecular Dynamics code of the class Particle-based Simulations. It implements a periodic simulation box filled with Lennard-Jones particles. In the code, a velocity-Verlet scheme is implemented in the <a class="el" href="main_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a> function.</p>
<p>Within one time step, the velocity-Verlet scheme sequentially performs:</p><ul>
<li>\( \mathbf{v}_i := \mathbf{v}_i + \frac{1}{2 m} \, \mathbf{f}_i \Delta t \), in <a class="el" href="dynamics_8c.html#a134ecc126c961d3564573eea201d9b1e">update_velocities_half_dt</a></li>
<li>Change velocities by thermostatting. This needs to be implemented in <a class="el" href="dynamics_8c.html#a4dbbb4f225a2b430031ecf67f90212f8">thermostat</a></li>
<li>\( \mathbf{r}_i := \mathbf{r}_i + \mathbf{v}_i \Delta t \) in <a class="el" href="dynamics_8c.html#aba25b3212f27acff62bd28cd332e6962">update_positions</a></li>
<li>Put all particles back in the simulation box, taking into account periodic boundary conditions in <a class="el" href="dynamics_8c.html#a91d151bd2a6ca7990a59eef0a8345bc6">boundary_conditions</a></li>
<li>Update the neighbor list in <a class="el" href="nbrlist_8c.html#a2a9dcf0bb1a7c560d3bd38c85ee7af0a">update_nbrlist</a></li>
<li>Compute forces in <a class="el" href="forces_8c.html#a9e2a98bcd2ac110d0e5a524234013d99">calculate_forces</a>, using the updated positions and neighbor list</li>
<li>\( \mathbf{v}_i := \mathbf{v}_i + \frac{1}{2 m} \, \mathbf{f}_i \Delta t \) in <a class="el" href="dynamics_8c.html#a134ecc126c961d3564573eea201d9b1e">update_velocities_half_dt</a></li>
</ul>
<h1 class="doxsection"><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<p>This Molecular Dynamics (MD) code simulates a one-species Lennard-Jones (LJ) fluid. The code models non-bonded interactions using the Lennard-Jones potential and is designed to compute the structural and dynamic properties of simple fluids.</p>
<p>The code is modular, with components responsible for initializing particle configurations, calculating forces, propagating the system in time using molecular dynamics, managing neighbor lists for efficient force calculation, and outputting data for visualization and further analysis.</p>
<h1 class="doxsection"><a class="anchor" id="structure_sec"></a>
Code Structure</h1>
<p>The code is organized into several key modules:</p>
<ul>
<li><b>main.c</b>: The central part of the simulation that initializes the system parameters, particle positions, velocities, and executes the main MD loop using velocity-Verlet integration.</li>
<li><b>initialise.c</b>: Handles system initialization, including setting up the initial particle positions and velocities. For the Lennard-Jones fluid, particles are placed in a simulation box with random initial positions and velocities.</li>
<li><b>forces.c</b>: Computes the non-bonded forces between particles using the Lennard-Jones potential. This module handles the force calculations based on the neighbor list, ensuring efficient computation for large systems.</li>
<li><b>dynamics.c</b>: Manages the time integration of the particle positions and velocities using the velocity-Verlet algorithm. This module also handles the application of boundary conditions and thermostats to control the temperature of the system.</li>
<li><b>nbrlist.c</b>: Maintains the neighbor list to optimize the calculation of non-bonded forces. The neighbor list reduces the number of particle pairs that need to be checked for interactions, improving the efficiency of the simulation.</li>
<li><b>fileoutput.c</b>: Outputs simulation data such as particle positions and energies in formats that can be used for post-simulation analysis and visualization.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="key_components"></a>
Key Components</h1>
<p>Here’s a breakdown of the key components in the code:</p>
<ul>
<li><b>Initialization (initialise.c)</b>:<ul>
<li>The <span class="tt">initialise</span> function sets up the particle positions and velocities at the start of the simulation. Particles are positioned randomly in a cubic simulation box, and their velocities are initialized according to a temperature-dependent Maxwell-Boltzmann distribution.</li>
</ul>
</li>
<li><b>Force Calculation (forces.c)</b>:<ul>
<li>The <span class="tt">calculate_forces</span> function computes the non-bonded forces between particles using the Lennard-Jones potential. The potential includes a cutoff distance to limit interactions to nearby particles, enhancing the efficiency of the simulation.</li>
<li>This module also supports periodic boundary conditions, ensuring that particles interact correctly across the boundaries of the simulation box.</li>
</ul>
</li>
<li><b>Time Integration (dynamics.c)</b>:<ul>
<li>The <span class="tt">update_positions</span> and <span class="tt">update_velocities_half_dt</span> functions implement the velocity-Verlet algorithm, which is used to propagate the system in time. The algorithm updates particle positions and velocities over each time step, ensuring the conservation of energy and stability of the simulation.</li>
<li>The <span class="tt">boundary_conditions</span> function applies periodic boundary conditions to ensure particles that move beyond the simulation box are wrapped around, maintaining a continuous system.</li>
</ul>
</li>
<li><b>Neighbor List (nbrlist.c)</b>:<ul>
<li>The <span class="tt">build_nbrlist</span> function constructs the neighbor list, which limits force calculations to nearby particles within a specified cutoff distance. This significantly reduces the computational cost for large systems by avoiding unnecessary force calculations between distant particles.</li>
</ul>
</li>
<li><b>Data Output (fileoutput.c)</b>:<ul>
<li>The <span class="tt">record_trajectories_pdb</span> and <span class="tt">record_trajectories_xyz</span> functions output particle positions in <span class="tt">.pdb</span> and <span class="tt">.xyz</span> formats, respectively. These files can be used for visualizing the particle configurations using external tools like OVITO.</li>
<li>Energy and other relevant system properties are also output periodically to help monitor the system’s evolution during the simulation.</li>
</ul>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="simulation_flow"></a>
Simulation Flow</h1>
<p>The typical flow of a simulation is as follows:</p>
<ol type="1">
<li><b>Initialization</b>:<ul>
<li>The system parameters (e.g., number of particles, temperature, time step, etc.) are set up.</li>
<li>The initial particle positions and velocities are initialized.</li>
</ul>
</li>
<li><b>Neighbor List Construction</b>:<ul>
<li>The neighbor list is built, ensuring that only nearby particles are considered for force calculations.</li>
</ul>
</li>
<li><b>Main MD Loop</b>:<ul>
<li>For each time step, the following steps are performed:<ul>
<li>Forces are calculated using the Lennard-Jones potential.</li>
<li>Particle velocities are updated (half-step).</li>
<li>Particle positions are updated.</li>
<li>Velocities are updated again (half-step) to complete the time step.</li>
<li>Periodic boundary conditions are applied to particles that move outside the simulation box.</li>
<li>Data is output at regular intervals.</li>
</ul>
</li>
</ul>
</li>
<li><b>Finalization</b>:<ul>
<li>The simulation ends after the specified number of time steps, and final data (e.g., particle positions) is saved.</li>
</ul>
</li>
</ol>
<h1 class="doxsection"><a class="anchor" id="additional_info"></a>
Additional Information</h1>
<ul>
<li><b>Units</b>: The code uses reduced units based on the Lennard-Jones potential. Ensure that the input parameters (e.g., temperature, time step) are specified in the correct reduced units for consistent results.</li>
<li><b>Extensions</b>: The modular structure of the code allows for easy extensions, such as adding bonded interactions (e.g., bond-stretch, angle-bend, dihedral-torsion) or implementing multi-species systems. The <span class="tt">forces.c</span> and <span class="tt">initialise.c</span> modules can be expanded to include these features.</li>
</ul>
<p>For further details, refer to the individual modules and their corresponding documentation. </p>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
